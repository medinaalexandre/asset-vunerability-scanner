<?php

namespace App\Http\Controllers;

use App\Http\Requests\CreateVulnerabilityRequest;
use App\UseCases\Vulnerability\CreateVulnerabilityUseCase;
use Illuminate\Http\JsonResponse;
use Symfony\Component\HttpFoundation\Response;

class VulnerabilityController extends Controller
{
    /**
     *
     * Create Vulnerability
     *
     * After you add a CVE-ID, our API will get details about the vulnerabilities from NVD API
     *
     * @operationId Create Vulnerability
     */
    public function create(CreateVulnerabilityRequest $request, CreateVulnerabilityUseCase $useCase): JsonResponse
    {
        $vulnerability = $useCase->execute($request->toDto());

        return response()->json(['id' => $vulnerability->id], Response::HTTP_CREATED);
    }
}
