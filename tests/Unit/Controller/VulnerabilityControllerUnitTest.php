<?php

use App\Http\Controllers\VulnerabilityController;
use App\Http\Requests\CreateVulnerabilityRequest;
use App\Models\Vulnerability;
use App\UseCases\Vulnerability\CreateVulnerabilityUseCase;

beforeEach(function () {
    $this->controller = new VulnerabilityController();
});

it('can create a vulnerability', function () {
    $useCaseMock = Mockery::mock(CreateVulnerabilityUseCase::class);
    $useCaseMock->shouldReceive('execute')
        ->once()
        ->andReturn(new Vulnerability());

    $this->controller->create(new CreateVulnerabilityRequest([
        'cve_id' => 'CVE-2025-1234',
    ]), $useCaseMock);
});
