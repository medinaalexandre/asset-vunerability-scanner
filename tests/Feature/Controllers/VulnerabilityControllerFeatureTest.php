<?php

use App\Http\Controllers\VulnerabilityController;
use App\Http\Requests\CreateVulnerabilityRequest;
use App\Models\User;
use App\Models\Vulnerability;
use App\UseCases\Vulnerability\CreateVulnerabilityUseCase;

it('can create a vulnerability', function () {
    $this->actingAs(User::factory()->create());
    $res = $this->post(route('vulnerabilities.create'), [
        'cve_id' => 'CVE-2025-1234',
    ])->assertCreated()
    ->assertJsonStructure(['id']);

    $this->assertDatabaseHas('vulnerabilities', ['id' => $res->json('id')]);
});
